<!DOCTYPE html>
<html>
<head>
    <title>Schedules</title>
    <style>
        body { font-family:Arial, sans-serif; margin:0; background:#eef1f7; }
        .header {
            background:#004aad; padding:18px 30px; color:white;
            display:flex; justify-content:space-between; align-items:center;
            box-shadow:0 2px 5px rgba(0,0,0,0.2);
        }
        .header h2 { margin:0; }
        .header a {
            color:#dbe7ff; text-decoration:none; margin-left:16px; font-size:14px;
        }
        .header a:hover { text-decoration:underline; }

        .container { width:90%; margin:25px auto 40px; }
        .card {
            background:#ffffff; padding:18px 20px; border-radius:10px;
            box-shadow:0px 3px 8px rgba(0,0,0,0.12);
        }

        table { width:100%; border-collapse:collapse; margin-top:10px;
                border-radius:8px; overflow:hidden; }
        th {
            background:#dfe4ea; padding:10px; text-align:left; font-size:13px;
            font-weight:600;
        }
        td {
            padding:9px 10px; border-bottom:1px solid #e3e3e3; font-size:13px;
            background:#fff;
        }
        tr:hover td { background:#f7f9fc; }

        .btn-primary {
            display:inline-block; padding:8px 14px; border-radius:6px;
            text-decoration:none; background:#0275d8; color:white;
            font-size:13px; margin-bottom:10px;
        }
        .btn-primary:hover { background:#025aa5; }

        /* Trip-type pill */
        .tag {
            display:inline-block;
            padding:4px 10px;
            font-size:11px;
            border-radius:999px;
            border:1px solid transparent;
            white-space:nowrap;
        }
        .tag-regular {
            border-color:#d1d5db;
            background:#f9fafb;
            color:#374151;
        }
        .tag-spare {
            border-color:#f97316;
            background:#fffbeb;
            color:#c2410c;
            font-weight:600;
        }
        .tag-spare small {
            font-weight:400;
            font-size:10px;
            opacity:0.8;
        }

        /* Starting point indicator */
        .start-point {
            font-size:12px;
            color:#f59e0b;
            font-weight:600;
        }
        .start-point-origin {
            font-size:12px;
            color:#6b7280;
        }
        .start-location {
            display:block;
            font-size:11px;
            color:#6b7280;
            margin-top:2px;
        }

        /* Action links */
        .action-link {
            color:#2563eb;
            text-decoration:none;
            font-size:12px;
            margin-right:10px;
        }
        .action-link:hover {
            text-decoration:underline;
        }
    </style>
</head>
<body>

<div class="header">
    <h2>Schedules ‚Äì {{ user.zone.name|default:"All Zones" }}</h2>
    <div>
        <a href="/zonal-admin/">Dashboard</a>
        <a href="/zonal-admin/preinforms/">Pre-Informs</a>
        <a href="/zonal-admin/demand/">Demand Alerts</a>
    </div>
</div>

<div class="container">
    <div class="card">
        <a href="/zonal-admin/assign-bus/" class="btn-primary">+ Assign New Bus</a>

        <table>
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Bus</th>
                    <th>Route</th>
                    <th>Date</th>
                    <th>Departure</th>
                    <th>Arrival</th>
                    <th>Driver</th>
                    <th>Type</th>
                    <th>Starting Point</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for s in schedules %}
                <tr>
                    <td>{{ s.id }}</td>
                    <td>{{ s.bus.number_plate }}</td>
                    <td>{{ s.route.number }} ‚Äì {{ s.route.name }}</td>
                    <td>{{ s.date }}</td>
                    <td>{{ s.departure_time }}</td>
                    <td>{{ s.arrival_time }}</td>
                    <td>{{ s.driver.email|truncatechars:20 }}</td>
                    
                    <!-- Trip Type -->
                    <td>
                        {% if s.is_spare_trip %}
                            <span class="tag tag-spare">
                                üöå Spare
                                {% if s.source_alert %}
                                    <small>(alert #{{ s.source_alert.id }})</small>
                                {% endif %}
                            </span>
                        {% else %}
                            <span class="tag tag-regular">Regular</span>
                        {% endif %}
                    </td>
                    
                    <!-- Starting Point -->
                    <td>
                        {% if s.current_stop_sequence > 0 %}
                            <span class="start-point">
                                Stop #{{ s.current_stop_sequence }}
                            </span>
                            {% if s.starting_stop %}
                                <span class="start-location">
                                    {{ s.starting_stop.name }}
                                </span>
                            {% endif %}
                        {% else %}
                            <span class="start-point-origin">Origin</span>
                        {% endif %}
                    </td>
                    
                    <!-- Actions -->
                    <td>
                        <a href="{% url 'verify-schedule' s.id %}" class="action-link">
                            üîç Verify
                        </a>
                        <a href="{% url 'schedule-load-prediction' s.id %}" class="action-link">
                            üìä Forecast
                        </a>
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="10" style="text-align:center; color:#6b7280; padding:20px;">
                        No schedules defined yet.
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

</body>
</html>